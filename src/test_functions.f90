module test_functions
    use env, only: wp

contains

    function rosenbrock(x) result(f)
        !--------------------------------------------------------------------------------------------------------------
        !! Multivariate Rosenbrock function
        !--------------------------------------------------------------------------------------------------------------
        real(wp) :: x(:)
        real(wp) :: f
        !--------------------------------------------------------------------------------------------------------------
        integer :: n, i
        n = size(x, 1)
        f = 0.0_wp
        do i = 1, n - 1
            f = f + (1.0_wp - x(i)) ** 2 + 100.0_wp * (x(i+1) - x(i) ** 2) ** 2
        end do
    end function rosenbrock


    function square(x) result(f)
        !--------------------------------------------------------------------------------------------------------------
        !! Multivariate square function
        !--------------------------------------------------------------------------------------------------------------
        real(wp) :: x(:)
        real(wp) :: f
        !--------------------------------------------------------------------------------------------------------------
        f = sum(x ** 2)
    end function square


    function constraints_example(x) result(c)
        !--------------------------------------------------------------------------------------------------------------
        !! Multivariate square function
        !! Example of constraints function for constraints:
        !! x(1) >= 1; x(2) <= 3; x(2) - x(1) >= 0
        !--------------------------------------------------------------------------------------------------------------
        real(wp)                :: x(:)
        real(wp), allocatable   :: c(:)
        !--------------------------------------------------------------------------------------------------------------
        allocate(c(3))
        c(1) = 1.0_wp - x(1)
        c(2) = x(2) - 3.0_wp
        c(3) = x(1) - x(2)
    end function constraints_example

end module test_functions